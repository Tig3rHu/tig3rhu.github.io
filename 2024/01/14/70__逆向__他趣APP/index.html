<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>apké€†å‘__ä»–è¶£APPè„±å£³&amp;è¿è¡Œç¯å¢ƒæ£€æµ‹åˆ†æ | Tig3rHu&#39;s Blog</title>
  <meta name="keywords" content="">
  <meta name="description" content="apké€†å‘__ä»–è¶£APPè„±å£³&amp;è¿è¡Œç¯å¢ƒæ£€æµ‹åˆ†æ | Tig3rHu&#39;s Blog">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="Android é©±åŠ¨ç¼–è¯‘èƒŒæ™¯Android å†…æ ¸é©±åŠ¨æ˜¯Androidä¸­è´Ÿè´£ç¡¬ä»¶çš„è¿æ¥å’Œæ“æ§ï¼Œç¡®ä¿ç¡¬ä»¶ä¸æ“ä½œç³»ç»Ÿçš„äº¤äº’ï¼Œè¿™äº›é©±åŠ¨æ˜¯å†…æ ¸çš„æ‹“å±•ç»„ä»¶ï¼Œé€šè¿‡æä¾›ç»Ÿä¸€çš„é©±åŠ¨æ“ä½œæ¥å£ä¾›ç”¨æˆ·å±‚ä½¿ç”¨ã€‚ Androidå†…æ ¸é©±åŠ¨ä¸»è¦åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼šAndroidä¸“ç”¨é©±åŠ¨å’ŒAndroidä½¿ç”¨çš„è®¾å¤‡é©±åŠ¨ï¼ˆåŸºäºLinuxï¼‰ã€‚å…¶ä¸­ï¼ŒAndroidä¸“ç”¨é©±åŠ¨åŒ…æ‹¬å¦‚Ashmemï¼ˆåŒ¿åå…±äº«å†…å­˜é©±åŠ¨ï¼‰ã€Loggerï¼ˆè½»é‡çº§çš„æ—¥å¿—é©±åŠ¨ï¼‰ã€">
<meta property="og:type" content="article">
<meta property="og:title" content="Pixel 6Pro Androidé©±åŠ¨æ¨¡å—ç¼–è¯‘">
<meta property="og:url" content="https://tig3rhu.github.io/2024/03/28/25__Pixel6P_Android%E9%A9%B1%E5%8A%A8%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91/index.html">
<meta property="og:site_name" content="Tig3rHu&#39;s Blog">
<meta property="og:description" content="Android é©±åŠ¨ç¼–è¯‘èƒŒæ™¯Android å†…æ ¸é©±åŠ¨æ˜¯Androidä¸­è´Ÿè´£ç¡¬ä»¶çš„è¿æ¥å’Œæ“æ§ï¼Œç¡®ä¿ç¡¬ä»¶ä¸æ“ä½œç³»ç»Ÿçš„äº¤äº’ï¼Œè¿™äº›é©±åŠ¨æ˜¯å†…æ ¸çš„æ‹“å±•ç»„ä»¶ï¼Œé€šè¿‡æä¾›ç»Ÿä¸€çš„é©±åŠ¨æ“ä½œæ¥å£ä¾›ç”¨æˆ·å±‚ä½¿ç”¨ã€‚ Androidå†…æ ¸é©±åŠ¨ä¸»è¦åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼šAndroidä¸“ç”¨é©±åŠ¨å’ŒAndroidä½¿ç”¨çš„è®¾å¤‡é©±åŠ¨ï¼ˆåŸºäºLinuxï¼‰ã€‚å…¶ä¸­ï¼ŒAndroidä¸“ç”¨é©±åŠ¨åŒ…æ‹¬å¦‚Ashmemï¼ˆåŒ¿åå…±äº«å†…å­˜é©±åŠ¨ï¼‰ã€Loggerï¼ˆè½»é‡çº§çš„æ—¥å¿—é©±åŠ¨ï¼‰ã€">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://tig3rhu.github.io/25__Pixel6P_Android%E9%A9%B1%E5%8A%A8%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91.assets/image-20240328225123329.png">
<meta property="og:image" content="https://tig3rhu.github.io/25__Pixel6P_Android%E9%A9%B1%E5%8A%A8%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91.assets/image-20240328230419169.png">
<meta property="og:image" content="https://tig3rhu.github.io/25__Pixel6P_Android%E9%A9%B1%E5%8A%A8%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91.assets/image-20240328152015762.png">
<meta property="og:image" content="https://tig3rhu.github.io/25__Pixel6P_Android%E9%A9%B1%E5%8A%A8%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91.assets/image-20240328160316362.png">
<meta property="og:image" content="https://tig3rhu.github.io/25__Pixel6P_Android%E9%A9%B1%E5%8A%A8%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91.assets/image-20240328162521161.png">
<meta property="og:image" content="https://tig3rhu.github.io/25__Pixel6P_Android%E9%A9%B1%E5%8A%A8%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91.assets/image-20240328163114575.png">
<meta property="og:image" content="https://tig3rhu.github.io/25__Pixel6P_Android%E9%A9%B1%E5%8A%A8%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91.assets/image-20240328162559303.png">
<meta property="og:image" content="https://tig3rhu.github.io/25__Pixel6P_Android%E9%A9%B1%E5%8A%A8%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91.assets/image-20240328164048154.png">
<meta property="og:image" content="https://tig3rhu.github.io/25__Pixel6P_Android%E9%A9%B1%E5%8A%A8%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91.assets/image-20240328164425527.png">
<meta property="article:published_time" content="2024-03-28T15:23:22.373Z">
<meta property="article:modified_time" content="2024-03-28T15:30:05.915Z">
<meta property="article:author" content="Tig3rHu">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tig3rhu.github.io/25__Pixel6P_Android%E9%A9%B1%E5%8A%A8%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91.assets/image-20240328225123329.png">


<link rel="icon" href="/img/heard.png">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-dark.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 7.0.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/heard.png"/>
</a>
<div class="author">
    <span>Tig3rHu</span>
</div>

<div class="icon">
    
        
            <a title="rss"
               href="/atom.xml"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-rss"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="github"
               href="https://github.com/Tig3rHu"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
</div>





<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(26)</small>
            
        </div>
    </li>
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
        <a 
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="26">

<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="http://yelog.org/">å¶è½é˜</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="æœç´¢ å¿«æ·é”® i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="åˆ‡æ¢åˆ°å¤§çº²è§†å›¾ å¿«æ·é”® w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="è¿”å›"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="å¤§å°å†™æ•æ„Ÿ"></i>
            <i class="iconfont icon-tag" data-title="æ ‡ç­¾"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">å¤§çº²</div>
            <i class="iconfont icon-list" data-title="åˆ‡æ¢åˆ°æ–‡ç« åˆ—è¡¨"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        
        <a  class="All "
           href="/2024/03/28/25__Pixel6P_Android%E9%A9%B1%E5%8A%A8%E6%A8%A1%E5%9D%97%E7%BC%96%E8%AF%91/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Pixel 6Pro Androidé©±åŠ¨æ¨¡å—ç¼–è¯‘">Pixel 6Pro Androidé©±åŠ¨æ¨¡å—ç¼–è¯‘</span>
            <span class="post-date" title="2024-03-28 23:23:22">2024/03/28</span>
        </a>
        
        
        <a  class="All "
           href="/2024/02/29/19__KernelSU%E6%90%9E%E6%9C%BA/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Pixel 6Pro Kernelç¼–è¯‘æ•´åˆKernelSU">Pixel 6Pro Kernelç¼–è¯‘æ•´åˆKernelSU</span>
            <span class="post-date" title="2024-02-29 11:27:35">2024/02/29</span>
        </a>
        
        
        <a  class="All "
           href="/2024/02/08/12__%E5%9C%A8Docker%E5%86%85%E7%BC%96%E8%AF%91AOSP%E5%85%A8%E8%BF%87%E7%A8%8B/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Pixel 6Pro AOSPæºç åœ¨Dockerå†…ç¼–è¯‘å…¨è¿‡ç¨‹">Pixel 6Pro AOSPæºç åœ¨Dockerå†…ç¼–è¯‘å…¨è¿‡ç¨‹</span>
            <span class="post-date" title="2024-02-08 18:38:54">2024/02/08</span>
        </a>
        
        
        <a  class="All "
           href="/2024/01/14/Motorola_Mesh%20%E6%BC%8F%E6%B4%9E%E5%85%AC%E5%91%8A/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Motorola_Meshæ¼æ´å…¬å‘Š">Motorola_Meshæ¼æ´å…¬å‘Š</span>
            <span class="post-date" title="2024-01-14 22:44:55">2024/01/14</span>
        </a>
        
        
        <a  class="All "
           href="/2024/01/14/110_jadx_%E5%86%85%E5%AD%98%E4%B8%8D%E5%A4%9F_%E4%BD%BF%E7%94%A8%E9%97%AA%E9%80%80/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="ç¯å¢ƒæ­å»º_jadx_å†…å­˜ä¸è¶³&amp;ä½¿ç”¨é—ªé€€">ç¯å¢ƒæ­å»º_jadx_å†…å­˜ä¸è¶³&amp;ä½¿ç”¨é—ªé€€</span>
            <span class="post-date" title="2024-01-14 22:20:30">2024/01/14</span>
        </a>
        
        
        <a  class="All "
           href="/2024/01/14/70__%E9%80%86%E5%90%91__%E4%BB%96%E8%B6%A3APP/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="apké€†å‘__ä»–è¶£APPè„±å£³&amp;è¿è¡Œç¯å¢ƒæ£€æµ‹åˆ†æ">apké€†å‘__ä»–è¶£APPè„±å£³&amp;è¿è¡Œç¯å¢ƒæ£€æµ‹åˆ†æ</span>
            <span class="post-date" title="2024-01-14 22:15:58">2024/01/14</span>
        </a>
        
        
        <a  class="All "
           href="/2024/01/07/68__%E9%80%86%E5%90%91__%E6%87%92%E4%BA%BA%E5%90%AC%E4%B9%A6%E5%8E%BB%E4%BC%9A%E5%91%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="apké€†å‘__æ‡’äººå¬ä¹¦é€†å‘">apké€†å‘__æ‡’äººå¬ä¹¦é€†å‘</span>
            <span class="post-date" title="2024-01-07 22:15:49">2024/01/07</span>
        </a>
        
        
        <a  class="All "
           href="/2024/01/03/67__%E9%80%86%E5%90%91__%E5%A9%9A%E7%A4%BC%E7%BA%AAAPP/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="apké€†å‘__å©šç¤¼çºªé€†å‘">apké€†å‘__å©šç¤¼çºªé€†å‘</span>
            <span class="post-date" title="2024-01-03 23:51:59">2024/01/03</span>
        </a>
        
        
        <a  class="All "
           href="/2024/01/02/13__Android%E5%90%84%E7%A7%8D%E6%9C%BA%E5%9E%8B%E5%88%B7%E6%9C%BA%E8%AE%B0%E5%BD%95/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Androidå„ç§æœºå‹åˆ·æœºè¸©å‘è®°å½•">Androidå„ç§æœºå‹åˆ·æœºè¸©å‘è®°å½•</span>
            <span class="post-date" title="2024-01-02 23:08:52">2024/01/02</span>
        </a>
        
        
        <a  class="All "
           href="/2024/01/02/65__%E9%80%86%E5%90%91_%E6%87%92%E4%BA%BA%E9%A9%BE%E8%80%83%E9%80%86%E5%90%91/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="apké€†å‘__æ‡’äººé©¾è€ƒå»ä¼šå‘˜">apké€†å‘__æ‡’äººé©¾è€ƒå»ä¼šå‘˜</span>
            <span class="post-date" title="2024-01-02 22:42:38">2024/01/02</span>
        </a>
        
        
        <a  class="All "
           href="/2024/01/02/66__%E9%80%86%E5%90%91_%E6%BB%B4%E7%AD%94%E6%B8%85%E5%8D%95%E5%8E%BB%E4%BC%9A%E5%91%98/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="apké€†å‘__æ»´ç­”æ¸…å•å»ä¼šå‘˜">apké€†å‘__æ»´ç­”æ¸…å•å»ä¼šå‘˜</span>
            <span class="post-date" title="2024-01-02 22:34:09">2024/01/02</span>
        </a>
        
        
        <a  class="All "
           href="/2023/12/18/45__%E8%93%9D%E7%89%99%20sniff%20&%20CTF/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="è“ç‰™sniff&amp;CTF&amp;develop">è“ç‰™sniff&amp;CTF&amp;develop</span>
            <span class="post-date" title="2023-12-18 17:30:59">2023/12/18</span>
        </a>
        
        
        <a  class="All "
           href="/2023/12/18/22_%E4%BD%BF%E7%94%A8LD_PROLOAD_%E8%BF%9B%E8%A1%8Chook/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Linux ä½¿ç”¨LD_PRELOAD è¿›è¡Œhook">Linux ä½¿ç”¨LD_PRELOAD è¿›è¡Œhook</span>
            <span class="post-date" title="2023-12-18 17:19:56">2023/12/18</span>
        </a>
        
        
        <a  class="All "
           href="/2023/12/18/3__QiLing_%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="QiLing æ¡†æ¶å­¦ä¹ WriteUp">QiLing æ¡†æ¶å­¦ä¹ WriteUp</span>
            <span class="post-date" title="2023-12-18 17:12:42">2023/12/18</span>
        </a>
        
        
        <a  class="All "
           href="/2023/12/18/mips%E6%9E%B6%E6%9E%84___%E5%A0%86%E6%A0%88%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E8%B0%83%E8%AF%95%E4%B8%8E%E5%88%A9%E7%94%A8/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="mipsæ¶æ„å †æ ˆç¼“å†²åŒºæº¢å‡ºè°ƒè¯•ä¸åˆ©ç”¨">mipsæ¶æ„å †æ ˆç¼“å†²åŒºæº¢å‡ºè°ƒè¯•ä¸åˆ©ç”¨</span>
            <span class="post-date" title="2023-12-18 16:47:08">2023/12/18</span>
        </a>
        
        
        <a  class="All "
           href="/2023/12/17/NetGear%20R7000P%20%E8%B7%AF%E7%94%B1%E5%99%A8%E6%A0%88%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E%E7%A1%AC%E4%BB%B6%E8%B0%83%E8%AF%95%E4%B8%8E%E5%88%86%E6%9E%90/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="NetGear R7000P è·¯ç”±å™¨æ ˆæº¢å‡ºæ¼æ´ç¡¬ä»¶è°ƒè¯•ä¸åˆ†æ">NetGear R7000P è·¯ç”±å™¨æ ˆæº¢å‡ºæ¼æ´ç¡¬ä»¶è°ƒè¯•ä¸åˆ†æ</span>
            <span class="post-date" title="2023-12-17 16:06:42">2023/12/17</span>
        </a>
        
        
        <a  class="All "
           href="/2023/12/16/NetGear_%E5%A4%9C%E9%B9%B0_RAX40V2_%E8%AE%BE%E5%A4%87%E4%B8%8E%E5%9B%BA%E4%BB%B6%E5%88%86%E6%9E%90/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="NetGear_å¤œé¹°_RAX40V2_è®¾å¤‡ä¸å›ºä»¶åˆ†æ">NetGear_å¤œé¹°_RAX40V2_è®¾å¤‡ä¸å›ºä»¶åˆ†æ</span>
            <span class="post-date" title="2023-12-16 20:57:42">2023/12/16</span>
        </a>
        
        
        <a  class="All "
           href="/2023/12/16/CVE-2021-20090(%E5%8D%8E%E7%A1%95DSL-AC3100)%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="CVE-2021-20090 èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´åˆ†æ">CVE-2021-20090 èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´åˆ†æ</span>
            <span class="post-date" title="2023-12-16 20:46:07">2023/12/16</span>
        </a>
        
        
        <a  class="All "
           href="/2023/12/16/NetGear_DGN2200v1%E7%B3%BB%E5%88%97%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="NetGear__DNG2200v1ç³»åˆ—æ¼æ´åˆ†æ">NetGear__DNG2200v1ç³»åˆ—æ¼æ´åˆ†æ</span>
            <span class="post-date" title="2023-12-16 20:34:25">2023/12/16</span>
        </a>
        
        
        <a  class="All "
           href="/2023/12/16/Linksys_EA6100_%E5%9B%BA%E4%BB%B6%E8%A7%A3%E5%AF%86%E5%88%86%E6%9E%90/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Linksys EA6100 å›ºä»¶è§£å¯†è¿‡ç¨‹">Linksys EA6100 å›ºä»¶è§£å¯†è¿‡ç¨‹</span>
            <span class="post-date" title="2023-12-16 20:20:43">2023/12/16</span>
        </a>
        
        
        <a  class="All "
           href="/2023/12/15/Cisco_RV110W_%E5%A0%86%E6%A0%88%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Cisco_RV110W_å †æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´åˆ†æå’Œåˆ©ç”¨">Cisco_RV110W_å †æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´åˆ†æå’Œåˆ©ç”¨</span>
            <span class="post-date" title="2023-12-15 23:01:41">2023/12/15</span>
        </a>
        
        
        <a  class="All "
           href="/2023/12/15/TP-Link_WR841n_%E8%B7%AF%E7%94%B1%E5%99%A8%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="TP-Link WR841n è·¯ç”±å™¨å¤šä¸ªç¼“å†²åŒºæº¢å‡ºæ¼æ´å¤ç°">TP-Link WR841n è·¯ç”±å™¨å¤šä¸ªç¼“å†²åŒºæº¢å‡ºæ¼æ´å¤ç°</span>
            <span class="post-date" title="2023-12-15 22:52:18">2023/12/15</span>
        </a>
        
        
        <a  class="All "
           href="/2023/12/15/USG310_4.70_%E5%9B%BA%E4%BB%B6%E8%A7%A3%E5%AF%86%E5%88%86%E6%9E%90/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="USG310_4.70_å›ºä»¶è§£å¯†åˆ†æ">USG310_4.70_å›ºä»¶è§£å¯†åˆ†æ</span>
            <span class="post-date" title="2023-12-15 22:47:02">2023/12/15</span>
        </a>
        
        
        <a  class="All "
           href="/2023/12/15/55__%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="github åšå®¢æ­å»ºè®°å½•">github åšå®¢æ­å»ºè®°å½•</span>
            <span class="post-date" title="2023-12-15 17:58:11">2023/12/15</span>
        </a>
        
        
        <a  class="All "
           href="/2023/12/15/Cisco%20Rv160%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Cisco Rv160 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´åˆ†æ">Cisco Rv160 è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´åˆ†æ</span>
            <span class="post-date" title="2023-12-15 17:01:20">2023/12/15</span>
        </a>
        
        
        <a  class="All "
           href="/2023/12/15/hello-world/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Hello World">Hello World</span>
            <span class="post-date" title="2023-12-15 15:15:35">2023/12/15</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="åˆ‡æ¢å…¨å± å¿«æ·é”® s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-70__é€†å‘__ä»–è¶£APP" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">apké€†å‘__ä»–è¶£APPè„±å£³&amp;è¿è¡Œç¯å¢ƒæ£€æµ‹åˆ†æ</h1>
    
    <div class="article-meta">
        
        
        
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2024-01-14 22:18:11'>2024-01-14 22:15</time>
        
    </div>
    <div class="article-meta">
        
        
        <span id="busuanzi_container_page_pv">
            Views ğŸ‘€ :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ROOT%E6%A3%80%E6%B5%8B"><span class="toc-text">ROOTæ£€æµ‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hook-%E6%A3%80%E6%B5%8B"><span class="toc-text">Hook æ£€æµ‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#load-so-js"><span class="toc-text">load_so.js</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hook-libnesc-so"><span class="toc-text">hook libnesc.so</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E6%98%93%E6%98%93%E7%9B%BE%E8%84%B1%E5%A3%B3"><span class="toc-text">ç½‘æ˜“æ˜“ç›¾è„±å£³</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E5%A3%B3"><span class="toc-text">æŸ¥å£³</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MT-%E7%AE%A1%E7%90%86%E5%99%A8"><span class="toc-text">MT ç®¡ç†å™¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PKID-%E6%9F%A5%E5%A3%B3"><span class="toc-text">PKID æŸ¥å£³</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dump-dex%E8%84%B1%E5%A3%B3"><span class="toc-text">dump_dexè„±å£³</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%86%E6%9E%90app%E5%86%85%E5%90%84%E7%A7%8D%E6%A3%80%E6%B5%8B"><span class="toc-text">åˆ†æappå†…å„ç§æ£€æµ‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#root-%E6%A3%80%E6%B5%8B"><span class="toc-text">root æ£€æµ‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E6%80%A7%E7%AD%BE%E5%90%8D%E6%A0%A1%E9%AA%8C"><span class="toc-text">å®Œæ•´æ€§ç­¾åæ ¡éªŒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%90%86%E6%A3%80%E6%B5%8B"><span class="toc-text">ä»£ç†æ£€æµ‹</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-text">å‚è€ƒ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%99%84%E5%BD%95"><span class="toc-text">é™„å½•</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84%E5%BD%95-1"><span class="toc-text">é™„å½• 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84%E5%BD%952"><span class="toc-text">é™„å½•2</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="ROOTæ£€æµ‹"><a href="#ROOTæ£€æµ‹" class="headerlink" title="ROOTæ£€æµ‹"></a>ROOTæ£€æµ‹</h2><p>â€œ  å½“å‰APPè¿è¡Œç¯å¢ƒå­˜åœ¨é£é™© (Rootè®¾å¤‡)ï¼Œè¯·æ‚¨åŠæ—¶çŸ¥æ™“å¹¶æ³¨æ„ä¿¡æ¯å®‰å…¨! â€œ</p>
<p><img src="/70__%E9%80%86%E5%90%91__%E4%BB%96%E8%B6%A3APP.assets/image-20240109221636023.png"></p>
<h2 id="Hook-æ£€æµ‹"><a href="#Hook-æ£€æµ‹" class="headerlink" title="Hook æ£€æµ‹"></a>Hook æ£€æµ‹</h2><p>ä½¿ç”¨ç®—æ³•åŠ©æ‰‹å®šä½åˆ°rootæ£€æµ‹å¼¹çª—çš„ä¸€äº›å¸¸è§„è®¾ç½®ï¼Œå»é™¤å¼¹çª—ï¼Œæˆ–è€…å…¶ä»–çš„ç»•è¿‡ã€‚<br>å½“ä½¿ç”¨ç®—æ³•åŠ©æ‰‹hook app çš„æ—¶å€™ï¼Œapp ä¼šæ£€æµ‹hook çš„ç¯å¢ƒï¼Œä»è€Œé—ªé€€ã€‚</p>
<p>ä½¿ç”¨frida è„šæœ¬ç›´æ¥é—ªé€€<br><img src="/70__%E9%80%86%E5%90%91__%E4%BB%96%E8%B6%A3APP.assets/image-20240110215010880.png"></p>
<blockquote>
<p> frida -U -p 32218 -l .\java_hooké€šæ€.js<br> å¯ä»¥çœ‹åˆ°ç›´æ¥ä¼šé—ªé€€ã€‚<br><img src="/70__%E9%80%86%E5%90%91__%E4%BB%96%E8%B6%A3APP.assets/image-20240110215626753.png"></p>
</blockquote>
<h3 id="load-so-js"><a href="#load-so-js" class="headerlink" title="load_so.js"></a>load_so.js</h3><p>è¿™é‡Œå¯ä»¥åˆ¤å®šapk ä½¿ç”¨äº†ä¸€äº›æ–¹æ³•æ¥é˜»æ­¢frida è¿›è¡Œhookï¼Œ ä¸€èˆ¬æ˜¯åœ¨ so æ–‡ä»¶å†…è¿›è¡Œå¤„ç†ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ç›´æ¥å¯ä»¥æ‰¾æ‰¾appåœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨äº†é‚£äº›soã€‚æœ€åè°ƒç”¨çš„é‚£ä¸ªso æ–‡ä»¶ï¼Œå°±æ˜¯æ£€æµ‹hookç¯å¢ƒçš„åº“æ–‡ä»¶ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// load_so.js</span><br><span class="line">var dlopen = Module.findExportByName(null, &quot;dlopen&quot;);</span><br><span class="line">var android_dlopen_ext = Module.findExportByName(null, &quot;android_dlopen_ext&quot;);</span><br><span class="line">Interceptor.attach(dlopen, &#123;</span><br><span class="line">    onEnter: function(args) &#123;</span><br><span class="line">        var path_ptr = args[0];</span><br><span class="line">        var path = ptr(path_ptr).readCString();</span><br><span class="line">        console.log(&quot;[dlopen:]&quot;, path);</span><br><span class="line">    &#125;,</span><br><span class="line">    onLeave: function(retval) &#123;&#125;</span><br><span class="line">&#125;);</span><br><span class="line">Interceptor.attach(android_dlopen_ext, &#123;</span><br><span class="line">    onEnter: function(args) &#123;</span><br><span class="line">        var path_ptr = args[0];</span><br><span class="line">        var path = ptr(path_ptr).readCString();</span><br><span class="line">        console.log(&quot;[dlopen_ext:]&quot;, path);</span><br><span class="line">    &#125;,</span><br><span class="line">    onLeave: function(retval) &#123;&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>


<p>ä½¿ç”¨è„šæœ¬ä¸€ç›´ä¸è¡Œï¼Œå› ä¸ºç”¨çš„ä¸€ç›´æ˜¯attachæ¨¡å¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Fridaä¸­çš„`spawn`å’Œ`attach`æ˜¯ä¸¤ç§ä¸åŒçš„æ“ä½œæ¨¡å¼ï¼Œç”¨äºä¸ç›®æ ‡è¿›ç¨‹è¿›è¡Œäº¤äº’ã€‚</span><br><span class="line"></span><br><span class="line">1. `spawn`æ¨¡å¼ï¼šåœ¨`spawn`æ¨¡å¼ä¸‹ï¼ŒFridaä¼šå¯åŠ¨ä¸€ä¸ªæ–°çš„ç›®æ ‡è¿›ç¨‹ï¼Œå¹¶ä¸”åœ¨è¯¥è¿›ç¨‹ä¸­åŠ è½½æŒ‡å®šçš„è„šæœ¬ã€‚è¿™æ„å‘³ç€ç›®æ ‡è¿›ç¨‹æ˜¯ç”±Fridaç›´æ¥åˆ›å»ºçš„ï¼Œå¹¶ä¸”å¯ä»¥åœ¨è¿›ç¨‹å¯åŠ¨æ—¶å°±æ³¨å…¥è„šæœ¬ã€‚ä½¿ç”¨`spawn`æ¨¡å¼å¯ä»¥åœ¨ç›®æ ‡è¿›ç¨‹è¿è¡Œä¹‹å‰å°±å¯¹å…¶è¿›è¡ŒåŠ¨æ€ä¿®æ”¹ã€ç›‘æ§æˆ–è°ƒè¯•ã€‚</span><br><span class="line">    </span><br><span class="line">2. `attach`æ¨¡å¼ï¼šåœ¨`attach`æ¨¡å¼ä¸‹ï¼ŒFridaä¼šè¿æ¥åˆ°ä¸€ä¸ªå·²ç»è¿è¡Œçš„ç›®æ ‡è¿›ç¨‹ï¼Œå¹¶ä¸”åœ¨è¯¥è¿›ç¨‹ä¸­åŠ è½½æŒ‡å®šçš„è„šæœ¬ã€‚è¿™æ„å‘³ç€ç›®æ ‡è¿›ç¨‹å¿…é¡»å·²ç»åœ¨è¿è¡Œä¸­ï¼Œè€Œä¸”Fridaéœ€è¦é€šè¿‡è¿›ç¨‹IDæˆ–è¿›ç¨‹åç§°å°†å…¶è¿æ¥èµ·æ¥ã€‚ä½¿ç”¨`attach`æ¨¡å¼å¯ä»¥åœ¨ç›®æ ‡è¿›ç¨‹è¿è¡Œæ—¶å¯¹å…¶è¿›è¡ŒåŠ¨æ€ä¿®æ”¹ã€ç›‘æ§æˆ–è°ƒè¯•ã€‚</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">æ€»ç»“è€Œè¨€ï¼Œ`spawn`æ¨¡å¼é€‚ç”¨äºåœ¨ç›®æ ‡è¿›ç¨‹å¯åŠ¨ä¹‹å‰æ³¨å…¥è„šæœ¬ï¼Œè€Œ`attach`æ¨¡å¼é€‚ç”¨äºè¿æ¥åˆ°å·²ç»è¿è¡Œçš„ç›®æ ‡è¿›ç¨‹å¹¶æ³¨å…¥è„šæœ¬ã€‚é€‰æ‹©ä½¿ç”¨å“ªç§æ¨¡å¼å–å†³äºæ‚¨çš„å…·ä½“éœ€æ±‚å’Œç›®æ ‡è¿›ç¨‹çš„çŠ¶æ€ã€‚</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ spawn æ¨¡å¼ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ libnesec.so æ–‡ä»¶ï¼Œè¿™æ˜¯ç½‘æ˜“æ˜“ç›¾çš„åŠ å£³soã€‚</p>
<p>è¿™æ˜¯pixel 6Pro æ‰‹æœºhook ,å¯ä»¥çœ‹åˆ°ã€‚</p>
<p><img src="/70__%E9%80%86%E5%90%91__%E4%BB%96%E8%B6%A3APP.assets/image-20240111100934608.png"></p>
<p>ä½†æ˜¯æ¢æˆmoto æ‰‹æœºå´ä¸è¡Œï¼Œâ€œ Failed to spawn: unexpectedly timed out while waiting for signal from process with PID 12337 â€ï¼ŒçŒœæµ‹è¿™ä¸æ‰‹æœºç³»ç»Ÿæœ‰å…³ã€‚</p>
<p><img src="/70__%E9%80%86%E5%90%91__%E4%BB%96%E8%B6%A3APP.assets/image-20240111101359601.png"></p>
<h3 id="hook-libnesc-so"><a href="#hook-libnesc-so" class="headerlink" title="hook libnesc.so"></a>hook libnesc.so</h3><p>å‰é¢æˆ‘ä»¬çŸ¥é“ libnesec ä¼šæ£€æµ‹frida hookï¼Œ é‚£ä¹ˆå¯ä»¥ç›´æ¥hook libnesec.so ï¼Œå½“è°ƒç”¨libnesec åº“çš„æ—¶å€™ï¼Œè®©å…¶è¿”å›ç©º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">function hook_pthread_create() &#123;</span><br><span class="line">    var pt_create_func = Module.findExportByName(&quot;libc.so&quot;, &#x27;pthread_create&#x27;);</span><br><span class="line">    Interceptor.attach(pt_create_func, &#123;</span><br><span class="line">        onEnter: function(args) &#123;</span><br><span class="line">            // æ˜¯é‚£ä¸ªsoæ–‡ä»¶è°ƒç”¨æˆ‘ï¼Œåˆ›å»ºçº¿ç¨‹</span><br><span class="line">            var so_name = Process.findModuleByAddress(args[2]).name;</span><br><span class="line">            if (so_name.indexOf(&quot;libnesec&quot;) != -1) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    Interceptor.replace(args[2], new NativeCallback(function() &#123;</span><br><span class="line">                        console.log(&#x27;replace success&#x27;);</span><br><span class="line">                        return null;</span><br><span class="line">                    &#125;, &#x27;void&#x27;, [&quot;void&quot;]));</span><br><span class="line">                &#125; catch (e) &#123;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        onLeave: function(retval) &#123;&#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">hook_pthread_create();</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°æ›¿æ¢æˆåŠŸäº†ã€‚</p>
<p><img src="/70__%E9%80%86%E5%90%91__%E4%BB%96%E8%B6%A3APP.assets/image-20240111223623332.png"></p>
<h2 id="ç½‘æ˜“æ˜“ç›¾è„±å£³"><a href="#ç½‘æ˜“æ˜“ç›¾è„±å£³" class="headerlink" title="ç½‘æ˜“æ˜“ç›¾è„±å£³"></a>ç½‘æ˜“æ˜“ç›¾è„±å£³</h2><p>ä½¿ç”¨ jadx  æ‰“å¼€ apk ï¼Œä¼šå‘ç°å­˜åœ¨ libnesec.so æ–‡ä»¶ï¼ŒçŒœæµ‹åŠ å›ºäº†ã€‚å› ä¸ºåç¼–è¯‘çœ‹ä¸åˆ°è¦çš„ä¼ªjavaæºç ã€‚å› æ­¤éœ€è¦å»è„±å£³ã€‚</p>
<p><img src="/70__%E9%80%86%E5%90%91__%E4%BB%96%E8%B6%A3APP.assets/image-20240109222700682.png"></p>
<h3 id="æŸ¥å£³"><a href="#æŸ¥å£³" class="headerlink" title="æŸ¥å£³"></a>æŸ¥å£³</h3><h4 id="MT-ç®¡ç†å™¨"><a href="#MT-ç®¡ç†å™¨" class="headerlink" title="MT ç®¡ç†å™¨"></a>MT ç®¡ç†å™¨</h4><p>å¯ä»¥æŸ¥å‡ºæ¥æ˜¯ç½‘æ˜“æ˜“ç›¾çš„åŠ å›º</p>
<h4 id="PKID-æŸ¥å£³"><a href="#PKID-æŸ¥å£³" class="headerlink" title="PKID æŸ¥å£³"></a>PKID æŸ¥å£³</h4><p>æŸ¥ä¸å‡ºæ¥ï¼Œçœ‹è¿‡åˆ«äººç”¨pkid å¯ä»¥æŸ¥å‡ºæ¥ï¼Œå¯èƒ½ç‰ˆæœ¬ä¸ä¸€æ ·ã€‚</p>
<h3 id="dump-dexè„±å£³"><a href="#dump-dexè„±å£³" class="headerlink" title="dump_dexè„±å£³"></a>dump_dexè„±å£³</h3><p>è„±å£³å‰æï¼š è¦ä¸€ç›´è¿è¡Œhook_libnesec.js æ–‡ä»¶ï¼Œä¿è¯frida èƒ½å¤Ÿhook è€Œä¸è¢«libnesec.so æ£€æµ‹åˆ°é—ªé€€ï¼Œå½±å“è„±å£³ã€‚<br><img src="/70__%E9%80%86%E5%90%91__%E4%BB%96%E8%B6%A3APP.assets/image-20240111223826464.png"></p>
<p>è„±å£³è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line">(function() &#123;</span><br><span class="line">    function klog(data) &#123;</span><br><span class="line">        var message = &#123;&#125;;</span><br><span class="line">        message[&quot;jsname&quot;] = &quot;dump_dex&quot;;</span><br><span class="line">        message[&quot;data&quot;] = data;</span><br><span class="line">        send(message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function klogData(data, key, value) &#123;</span><br><span class="line">        var message = &#123;&#125;;</span><br><span class="line">        message[&quot;jsname&quot;] = &quot;dump_dex&quot;;</span><br><span class="line">        message[&quot;data&quot;] = data;</span><br><span class="line">        message[key] = value;</span><br><span class="line">        send(message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function get_self_process_name() &#123;</span><br><span class="line">        var openPtr = Module.getExportByName(&#x27;libc.so&#x27;, &#x27;open&#x27;);</span><br><span class="line">        var open = new NativeFunction(openPtr, &#x27;int&#x27;, [&#x27;pointer&#x27;, &#x27;int&#x27;]);</span><br><span class="line"></span><br><span class="line">        var readPtr = Module.getExportByName(&quot;libc.so&quot;, &quot;read&quot;);</span><br><span class="line">        var read = new NativeFunction(readPtr, &quot;int&quot;, [&quot;int&quot;, &quot;pointer&quot;, &quot;int&quot;]);</span><br><span class="line"></span><br><span class="line">        var closePtr = Module.getExportByName(&#x27;libc.so&#x27;, &#x27;close&#x27;);</span><br><span class="line">        var close = new NativeFunction(closePtr, &#x27;int&#x27;, [&#x27;int&#x27;]);</span><br><span class="line"></span><br><span class="line">        var path = Memory.allocUtf8String(&quot;/proc/self/cmdline&quot;);</span><br><span class="line">        var fd = open(path, 0);</span><br><span class="line">        if (fd != -1) &#123;</span><br><span class="line">            var buffer = Memory.alloc(0x1000);</span><br><span class="line"></span><br><span class="line">            var result = read(fd, buffer, 0x1000);</span><br><span class="line">            close(fd);</span><br><span class="line">            result = ptr(buffer).readCString();</span><br><span class="line">            return result;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return &quot;-1&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    function mkdir(path) &#123;</span><br><span class="line">        var mkdirPtr = Module.getExportByName(&#x27;libc.so&#x27;, &#x27;mkdir&#x27;);</span><br><span class="line">        var mkdir = new NativeFunction(mkdirPtr, &#x27;int&#x27;, [&#x27;pointer&#x27;, &#x27;int&#x27;]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        var opendirPtr = Module.getExportByName(&#x27;libc.so&#x27;, &#x27;opendir&#x27;);</span><br><span class="line">        var opendir = new NativeFunction(opendirPtr, &#x27;pointer&#x27;, [&#x27;pointer&#x27;]);</span><br><span class="line"></span><br><span class="line">        var closedirPtr = Module.getExportByName(&#x27;libc.so&#x27;, &#x27;closedir&#x27;);</span><br><span class="line">        var closedir = new NativeFunction(closedirPtr, &#x27;int&#x27;, [&#x27;pointer&#x27;]);</span><br><span class="line"></span><br><span class="line">        var cPath = Memory.allocUtf8String(path);</span><br><span class="line">        var dir = opendir(cPath);</span><br><span class="line">        if (dir != 0) &#123;</span><br><span class="line">            closedir(dir);</span><br><span class="line">            return 0;</span><br><span class="line">        &#125;</span><br><span class="line">        mkdir(cPath, 755);</span><br><span class="line">        chmod(path);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function chmod(path) &#123;</span><br><span class="line">        var chmodPtr = Module.getExportByName(&#x27;libc.so&#x27;, &#x27;chmod&#x27;);</span><br><span class="line">        var chmod = new NativeFunction(chmodPtr, &#x27;int&#x27;, [&#x27;pointer&#x27;, &#x27;int&#x27;]);</span><br><span class="line">        var cPath = Memory.allocUtf8String(path);</span><br><span class="line">        chmod(cPath, 755);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function dump_dex() &#123;</span><br><span class="line">        var libart = Process.findModuleByName(&quot;libart.so&quot;);</span><br><span class="line">        var addr_DefineClass = null;</span><br><span class="line">        var symbols = libart.enumerateSymbols();</span><br><span class="line">        for (var index = 0; index &lt; symbols.length; index++) &#123;</span><br><span class="line">            var symbol = symbols[index];</span><br><span class="line">            var symbol_name = symbol.name;</span><br><span class="line">            //è¿™ä¸ªDefineClassçš„å‡½æ•°ç­¾åæ˜¯Android9çš„</span><br><span class="line">            //_ZN3art11ClassLinker11DefineClassEPNS_6ThreadEPKcmNS_6HandleINS_6mirror11ClassLoaderEEERKNS_7DexFileERKNS9_8ClassDefE</span><br><span class="line">            if (symbol_name.indexOf(&quot;ClassLinker&quot;) &gt;= 0 &amp;&amp;</span><br><span class="line">                symbol_name.indexOf(&quot;DefineClass&quot;) &gt;= 0 &amp;&amp;</span><br><span class="line">                symbol_name.indexOf(&quot;Thread&quot;) &gt;= 0 &amp;&amp;</span><br><span class="line">                symbol_name.indexOf(&quot;DexFile&quot;) &gt;= 0) &#123;</span><br><span class="line">                console.log(symbol_name, symbol.address);</span><br><span class="line">                addr_DefineClass = symbol.address;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        var dex_maps = &#123;&#125;;</span><br><span class="line">        var dex_count = 1;</span><br><span class="line"></span><br><span class="line">        console.log(&quot;[DefineClass:]&quot;, addr_DefineClass);</span><br><span class="line">        if (addr_DefineClass) &#123;</span><br><span class="line">            Interceptor.attach(addr_DefineClass, &#123;</span><br><span class="line">                onEnter: function(args) &#123;</span><br><span class="line">                    var dex_file = args[5];</span><br><span class="line">                    //ptr(dex_file).add(Process.pointerSize) is &quot;const uint8_t* const begin_;&quot;</span><br><span class="line">                    //ptr(dex_file).add(Process.pointerSize + Process.pointerSize) is &quot;const size_t size_;&quot;</span><br><span class="line">                    var base = ptr(dex_file).add(Process.pointerSize).readPointer();</span><br><span class="line">                    var size = ptr(dex_file).add(Process.pointerSize + Process.pointerSize).readUInt();</span><br><span class="line"></span><br><span class="line">                    if (dex_maps[base] == undefined) &#123;</span><br><span class="line">                        dex_maps[base] = size;</span><br><span class="line">                        var magic = ptr(base).readCString();</span><br><span class="line">                        if (magic.indexOf(&quot;dex&quot;) == 0) &#123;</span><br><span class="line"></span><br><span class="line">                            var process_name = get_self_process_name();</span><br><span class="line">                            if (process_name != &quot;-1&quot;) &#123;</span><br><span class="line">                                var dex_dir_path = &quot;/data/data/&quot; + process_name + &quot;/files/dump_dex_&quot; + process_name;</span><br><span class="line">                                mkdir(dex_dir_path);</span><br><span class="line">                                var dex_path = dex_dir_path + &quot;/class&quot; + (dex_count == 1 ? &quot;&quot; : dex_count) + &quot;.dex&quot;;</span><br><span class="line">                                console.log(&quot;[find dex]:&quot;, dex_path);</span><br><span class="line">                                var fd = new File(dex_path, &quot;wb&quot;);</span><br><span class="line">                                if (fd &amp;&amp; fd != null) &#123;</span><br><span class="line">                                    dex_count++;</span><br><span class="line">                                    var dex_buffer = ptr(base).readByteArray(size);</span><br><span class="line">                                    fd.write(dex_buffer);</span><br><span class="line">                                    fd.flush();</span><br><span class="line">                                    fd.close();</span><br><span class="line">                                    console.log(&quot;[dump dex]:&quot;, dex_path);</span><br><span class="line"></span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                onLeave: function(retval) &#123;&#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function main() &#123;</span><br><span class="line">        klogData(&quot;&quot;, &quot;init&quot;, &quot;dump_dex.js init hook success&quot;)</span><br><span class="line">        dump_dex();</span><br><span class="line">    &#125;</span><br><span class="line">    setImmediate(main);</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿è¡Œ  frida -UF -l .\dump_dex.js  ï¼Œ ä¸ºäº†ä¿è¯èƒ½è„±å£³ï¼Œapp çš„æ¯ä¸ªæ¿å—éƒ½ç‚¹ä¸€ç‚¹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users\TigerHu\NewFlold\7__study\2__Frida\ä»–è¶£è„±å£³&gt; frida -UF -l .\dump_dex.js</span><br><span class="line">     ____</span><br><span class="line">    / _  |   Frida 16.1.0 - A world-class dynamic instrumentation toolkit</span><br><span class="line">   | (_| |</span><br><span class="line">    &gt; _  |   Commands:</span><br><span class="line">   /_/ |_|       help      -&gt; Displays the help system</span><br><span class="line">   . . . .       object?   -&gt; Display information about &#x27;object&#x27;</span><br><span class="line">   . . . .       exit/quit -&gt; Exit</span><br><span class="line">   . . . .</span><br><span class="line">   . . . .   More info at https://frida.re/docs/home/</span><br><span class="line">   . . . .</span><br><span class="line">   . . . .   Connected to Pixel 6 Pro (id=1B231FDEE005T0)</span><br><span class="line">_ZN3art11ClassLinker11DefineClassEPNS_6ThreadEPKcmNS_6HandleINS_6mirror11ClassLoaderEEERKNS_7DexFileERKNS_3dex8ClassDefE 0x6d87590ab0</span><br><span class="line">[DefineClass:] 0x6d87590ab0</span><br><span class="line">message: &#123;&#x27;type&#x27;: &#x27;send&#x27;, &#x27;payload&#x27;: &#123;&#x27;jsname&#x27;: &#x27;dump_dex&#x27;, &#x27;data&#x27;: &#x27;&#x27;, &#x27;init&#x27;: &#x27;dump_dex.js init hook success&#x27;&#125;&#125; data: None</span><br><span class="line">[Pixel 6 Pro::ä»–è¶£ ]-&gt; [find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class2.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class2.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class3.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class3.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class4.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class4.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class5.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class5.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class6.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class6.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class7.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class7.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class8.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class8.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class9.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class9.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class10.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class10.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class11.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class11.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class12.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class12.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class13.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class13.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class14.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class14.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class15.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class15.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class16.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class16.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class17.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class17.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class18.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class18.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class19.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class19.dex</span><br><span class="line">[find dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class20.dex</span><br><span class="line">[dump dex]: /data/data/com.xingjiabi.shengsheng/files/dump_dex_com.xingjiabi.shengsheng/class20.dex</span><br></pre></td></tr></table></figure>

<p>åœ¨æ‰‹æœºå†…å¯ä»¥çœ‹åˆ°è„±å£³å‡ºæ¥çš„dex æ–‡ä»¶ï¼Œéšåç›´æ¥æ‹–åˆ°jadxé‡Œï¼Œå°±å¯ä»¥åˆ†æäº†ã€‚<br><img src="/70__%E9%80%86%E5%90%91__%E4%BB%96%E8%B6%A3APP.assets/image-20240111224602621.png"></p>
<h1 id="åˆ†æappå†…å„ç§æ£€æµ‹"><a href="#åˆ†æappå†…å„ç§æ£€æµ‹" class="headerlink" title="åˆ†æappå†…å„ç§æ£€æµ‹"></a>åˆ†æappå†…å„ç§æ£€æµ‹</h1><p>åˆ†æapp åè°ƒè¯•ã€è¿è¡Œç¯å¢ƒæ£€æµ‹æŠ€æœ¯ã€‚</p>
<h2 id="root-æ£€æµ‹"><a href="#root-æ£€æµ‹" class="headerlink" title="root æ£€æµ‹"></a>root æ£€æµ‹</h2><p>å‰é¢æˆ‘ä»¬çŸ¥é“app ä¼šå¯¹è¿è¡Œç¯å¢ƒè¿›è¡Œæ£€æµ‹ï¼Œä½†æ˜¯ç›´æ¥æœç´¢ å­—ç¬¦ä¸² å¼¹çª—çš„ä¿¡æ¯ï¼Œæ˜¯æœä¸å‡ºæ¥çš„ï¼Œè¿™æ˜¯ç”±äº apk å¯¹å­—ç¬¦ä¸²åšäº†base64 å¤„ç†ã€‚</p>
<p>ç„¶åä»¥å‰åˆ†æè¿‡ä¸€äº›å¯¹root ç¯å¢ƒç›‘æµ‹çš„ä»£ç ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥æœç´¢ï¼Œå®šä½åˆ°ä»£ç  cn.taqu.lib.base.utils.AppAntiUtils.isDeviceRooted()<br><img src="/70__%E9%80%86%E5%90%91__%E4%BB%96%E8%B6%A3APP.assets/image-20240112145319294.png"><br><img src="/70__%E9%80%86%E5%90%91__%E4%BB%96%E8%B6%A3APP.assets/image-20240114160423598.png"></p>
<p>ç„¶åæ‰¾åˆ°è¿™ä¸€å—çš„ä»£ç <br><img src="/70__%E9%80%86%E5%90%91__%E4%BB%96%E8%B6%A3APP.assets/image-20240112145342031.png"></p>
<p>base64 è§£ç <br><img src="/70__%E9%80%86%E5%90%91__%E4%BB%96%E8%B6%A3APP.assets/image-20240112145108350.png"></p>
<p>å¦å¤–è¿˜çœ‹åˆ°ä¸ä»…ä»…å¯¹ su è¿›è¡Œæ£€æµ‹ï¼Œè¿˜æ£€æµ‹äº†å…¶ä»–çš„é¡¹ï¼Œå¦‚ä¸‹å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°åœ¨ cn.taqu.lib.base.utils.AppAntiUtils.initAnti() åˆå§‹åŒ–çš„æ—¶å€™è°ƒç”¨ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public static boolean isDeviceRooted(RootBeer rootBeer) &#123;</span><br><span class="line">  </span><br><span class="line">    HbTrace.d(38850);</span><br><span class="line">    boolean z2 = rootBeer.checkForBinary(x.f13157a) || rootBeer.checkForDangerousProps() || rootBeer.checkForRWPaths() || rootBeer.detectTestKeys() || rootBeer.checkSuExists() || rootBeer.checkForRootNative() || rootBeer.checkForMagiskBinary();</span><br><span class="line">    HbTrace.h(38850);</span><br><span class="line">    return z2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°è°ƒç”¨äº† isDeviceRootedï¼Œä¸¤ä¸ªé‡æ„å‡½æ•°ï¼Œæ¥åˆ¤æ–­æ˜¯å¦rootï¼Œæœ€åå¼¹çª—</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cn.taqu.lib.base.utils.AppAntiUtils.initAnti()</span><br><span class="line"></span><br><span class="line">if (!AppAntiUtils.access$900() &amp;&amp; !AppAntiUtils.access$1000() &amp;&amp; &quot;1&quot;.equals(AppAntiUtils.access$200())) &#123;</span><br><span class="line">	boolean isDeviceRooted = AppAntiUtils.isDeviceRooted(); // åˆ¤æ–­su</span><br><span class="line">	boolean isDeviceRooted2 = AppAntiUtils.isDeviceRooted(RootBeer.this); // åˆ¤æ–­å…¶ä»–</span><br><span class="line">	if (isDeviceRooted2 || isDeviceRooted) &#123;</span><br><span class="line">		Loger.g(AppAntiUtils.TAG, PushConstants.PUSH_VALUE_ROOT);</span><br><span class="line">		XLogUpload.k(&quot;AntiRoot&quot;).b(&quot;device rooted.&quot;).m(&quot;RootBeer&quot;, String.valueOf(isDeviceRooted2)).m(&quot;DeviceRooted&quot;, String.valueOf(isDeviceRooted)).o();</span><br><span class="line">		AppAntiUtils.access$1100();  // å¼¹çª—</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ¥åˆ†æä¸€ä¸‹ isDeviceRooted(RootBeer rootBeer) å†…å¯¹è¿è¡Œç¯å¢ƒæ˜¯å¦‚ä½•æ£€æµ‹çš„ä»£ç ã€‚<br>é¦–å…ˆåˆ†æä¸€ä¸‹ rootBeer.checkForBinary(x.f13157a)ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯æ£€æµ‹åœ¨ä¸€äº›æ–‡ä»¶è·¯å¾„å†…æ˜¯å¦å­˜åœ¨ x.f13157a ( su æ–‡ä»¶ )ï¼Œ æœ‰å…³Const.getPaths() å‡½æ•°çš„ä»£ç è¯¦è§é™„å½• 1 ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public boolean checkForBinary(String str) &#123;</span><br><span class="line">    String[] paths;</span><br><span class="line">    boolean z2 = false;</span><br><span class="line">    for (String str2 : Const.getPaths()) &#123;</span><br><span class="line">        String str3 = str2 + str;</span><br><span class="line">        if (new File(str2, str).exists()) &#123;</span><br><span class="line">            QLog.v(str3 + &quot; binary detected!&quot;);</span><br><span class="line">            z2 = true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return z2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p> rootBeer.checkForDangerousProps() å°±æ˜¯åˆ¤æ–­ç³»ç»Ÿçš„è°ƒè¯•æ¨¡å¼æ˜¯å¦è¢«æ‰“å¼€ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public boolean checkForDangerousProps() &#123;</span><br><span class="line">    HashMap hashMap = new HashMap();</span><br><span class="line">    hashMap.put(&quot;ro.debuggable&quot;, &quot;1&quot;);</span><br><span class="line">    hashMap.put(&quot;ro.secure&quot;, &quot;0&quot;);</span><br><span class="line">    String[] propsReader = propsReader();</span><br><span class="line">    if (propsReader == null) &#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">    boolean z2 = false;</span><br><span class="line">    for (String str : propsReader) &#123;</span><br><span class="line">        for (String str2 : hashMap.keySet()) &#123;</span><br><span class="line">            if (str.contains(str2)) &#123;</span><br><span class="line">                String str3 = &quot;[&quot; + ((String) hashMap.get(str2)) + &quot;]&quot;;</span><br><span class="line">                if (str.contains(str3)) &#123;</span><br><span class="line">                    QLog.v(str2 + &quot; = &quot; + str3 + &quot; detected!&quot;);</span><br><span class="line">                    z2 = true;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return z2;</span><br></pre></td></tr></table></figure>

<p>rootBeer.checkForRWPaths() æ£€æŸ¥ç³»ç»Ÿä¸­æ˜¯å¦å­˜åœ¨è¢«æŒ‚è½½ä¸ºå¯è¯»å†™ï¼ˆrwï¼‰æƒé™çš„åº”ç”¨ç¨‹åºæ•°æ®ç›®å½•ä»¥åŠå…¶ä»–æŒ‡å®šçš„è·¯å¾„ï¼Œå¹¶è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼è¡¨ç¤ºæ˜¯å¦å­˜åœ¨è¿™æ ·çš„è·¯å¾„ã€‚è¯¥å‡½æ•°ä¼šè¯»å–ç³»ç»Ÿä¸­å…³äºæŒ‚è½½ç‚¹çš„ä¿¡æ¯ï¼Œæ£€æŸ¥æ¯ä¸€ä¸ªæŒ‚è½½ç‚¹çš„è·¯å¾„å’Œæƒé™ä¿¡æ¯ï¼Œå¦‚æœå‘ç°æŸä¸ªè·¯å¾„è¢«æŒ‚è½½ä¸ºå¯è¯»å†™æƒé™ï¼Œåˆ™ä¼šè¾“å‡ºç›¸åº”çš„æ—¥å¿—ä¿¡æ¯å¹¶å°†è¿”å›å€¼è®¾ä¸º trueã€‚è¯¥å‡½æ•°å¯ä»¥ç”¨äºæ£€æµ‹ç³»ç»Ÿå®‰å…¨æ€§ï¼Œé˜²æ­¢åº”ç”¨ç¨‹åºæ»¥ç”¨é«˜æƒé™ç›®å½•ï¼Œä»£ç å¤ªé•¿ï¼Œè¯¦è§ é™„å½• 2 ã€‚</p>
<p>rootBeer.detectTestKeys() è¯¥å‡½æ•°ä¼šè¯»å–è®¾å¤‡çš„ Build.TAGS å­—æ®µæ˜¯å¦æœ‰ â€œ test-keys â€ï¼Œæ£€æµ‹å½“å‰è®¾å¤‡æ˜¯å¦ä½¿ç”¨æµ‹è¯•ç”¨çš„å¯†é’¥ç­¾åã€‚</p>
<p>root.Beer. checkSuExists() å‡½æ•°ä¼šè°ƒç”¨ which å‘½ä»¤ï¼ŒæŸ¥æ‰¾æ˜¯å¦å­˜åœ¨ su å‘½ä»¤ã€‚</p>
<p>rootBeer.checkForRootNative() å‡½æ•°ä¼šåŠ è½½æœ¬åœ° toolChecker çš„ lib åº“æ–‡ä»¶æ¥æ£€æµ‹æ˜¯å¦è¢«è·å–root æƒé™ï¼Œè°ƒç”¨ native å†…çš„ checkForRoot() å‡½æ•°ï¼Œæ¥åˆ¤æ–­è®¾å¤‡æ˜¯å¦è·å¾—rootæƒé™ï¼Œå…¶å®è¿˜æ˜¯æ£€æµ‹æ˜¯å¦å­˜åœ¨ su æ–‡ä»¶ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public class RootBeerNative &#123;</span><br><span class="line">    private static boolean libraryLoaded = false;</span><br><span class="line"></span><br><span class="line">    static &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            System.loadLibrary(&quot;toolChecker&quot;);</span><br><span class="line">            libraryLoaded = true;</span><br><span class="line">        &#125; catch (UnsatisfiedLinkError e) &#123;</span><br><span class="line">            QLog.e(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public native int checkForRoot(Object[] objArr);</span><br><span class="line">    public native int setLogDebugMessages(boolean z2);</span><br><span class="line">    public boolean wasNativeLibraryLoaded() &#123;</span><br><span class="line">        return libraryLoaded;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>rootBeer.checkForMagiskBinary() æ£€æµ‹æ˜¯å¦å­˜åœ¨Magisk é¢å…·ï¼Œå¦‚æœè¿›ç¨‹åè¢«æ›´æ”¹å°±æ£€æµ‹ä¸åˆ°äº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public boolean checkForMagiskBinary() &#123;</span><br><span class="line">    return checkForBinary(&quot;magisk&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶å®è¿˜æœ‰ä¸€äº›æ£€æµ‹çš„ä»£ç ï¼Œè¿™ä¸ªapp å¯¹root æ£€æµ‹å·²ç»æ˜¯ç›¸å½“çš„å…¨é¢äº†ã€‚</p>
<h2 id="å®Œæ•´æ€§ç­¾åæ ¡éªŒ"><a href="#å®Œæ•´æ€§ç­¾åæ ¡éªŒ" class="headerlink" title="å®Œæ•´æ€§ç­¾åæ ¡éªŒ"></a>å®Œæ•´æ€§ç­¾åæ ¡éªŒ</h2><p>è®¡ç®—ç­¾åæ‘˜è¦ï¼Œè¿›è¡Œå¯¹æ¯”ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#125; else if (!sHbSignature.equals(getSHA1Signature(BaseApplication.getInstance()))) &#123;</span><br><span class="line">    XLogUpload.k(&quot;AntiSign&quot;).b(&quot;ç­¾åæ–‡ä»¶ä¸ä¸€è‡´&quot;).o();</span><br><span class="line">    ToastUtils.b(BaseApplication.getInstance(), new String(Base64.decode(&quot;5qOA5rWL5Yiw5oKo5a6J6KOF5YiwQVBQ5a2Y5Zyo6Zeu6aKY77yM5Li65LqG5L+d6K+B5q2j5bi45L2/55So6K+35LiL6L295a6Y5pa554mI5pys&quot;, 0)));</span><br><span class="line">    System.exit(0);</span><br><span class="line">    HbTrace.h(38784);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="ä»£ç†æ£€æµ‹"><a href="#ä»£ç†æ£€æµ‹" class="headerlink" title="ä»£ç†æ£€æµ‹"></a>ä»£ç†æ£€æµ‹</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">cn.taqu.lib.base.utils.AppAntiUtils line21~line22</span><br><span class="line"></span><br><span class="line">	if (!AppAntiUtils.access$600() &amp;&amp; !AppAntiUtils.access$700() &amp;&amp; !ApplicationHelper.u() &amp;&amp; OkHttpDns.a(BaseApplication.getInstance())) &#123;</span><br><span class="line">		AppAntiUtils.access$800();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">hb.common.helper.OKHttpDns line1~line2</span><br><span class="line">    public static boolean a(Context ctx) &#123;</span><br><span class="line">        HbTrace.d(44874);</span><br><span class="line">        String property = System.getProperty(&quot;http.proxyHost&quot;);</span><br><span class="line">        String property2 = System.getProperty(&quot;http.proxyPort&quot;);</span><br><span class="line">        if (property2 == null) &#123;</span><br><span class="line">            property2 = &quot;-1&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        boolean z2 = (property == null || Integer.parseInt(property2) == -1) ? false : true;</span><br><span class="line">        HbTrace.h(44874);</span><br><span class="line">        return z2;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>




<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p>APP ä½¿ç”¨frida åè°ƒè¯•æ£€æµ‹ç»•è¿‡<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/dxmao/articles/17678351.html">https://www.cnblogs.com/dxmao/articles/17678351.html</a></p>
<p>è§†é¢‘è®²è§£<br><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1e94y1V7wZ/?spm_id_from=333.999.0.0&vd_source=cd4aba572b443cbbb4c522c3c649652d">https://www.bilibili.com/video/BV1e94y1V7wZ/?spm_id_from=333.999.0.0&amp;vd_source=cd4aba572b443cbbb4c522c3c649652d</a></p>
<h1 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h1><h2 id="é™„å½•-1"><a href="#é™„å½•-1" class="headerlink" title="é™„å½• 1"></a>é™„å½• 1</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">package com.scottyab.rootbeer;</span><br><span class="line"></span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.Arrays;</span><br><span class="line">import me.panpf.sketch.uri.FileUriModel;</span><br><span class="line"></span><br><span class="line">/* loaded from: E:\file\androidé€†å‘\è“ç‹è§†é¢‘\ä»–è¶£app\class13.dex */</span><br><span class="line">final class Const &#123;</span><br><span class="line">    static final String BINARY_BUSYBOX = &quot;busybox&quot;;</span><br><span class="line">    static final String BINARY_SU = &quot;su&quot;;</span><br><span class="line">    static final String[] knownRootAppsPackages = &#123;&quot;com.noshufou.android.su&quot;, &quot;com.noshufou.android.su.elite&quot;, &quot;eu.chainfire.supersu&quot;, &quot;com.koushikdutta.superuser&quot;, &quot;com.thirdparty.superuser&quot;, &quot;com.yellowes.su&quot;, &quot;com.topjohnwu.magisk&quot;, &quot;com.kingroot.kinguser&quot;, &quot;com.kingo.root&quot;, &quot;com.smedialink.oneclickroot&quot;, &quot;com.zhiqupk.root.global&quot;, &quot;com.alephzain.framaroot&quot;&#125;;</span><br><span class="line">    public static final String[] knownDangerousAppsPackages = &#123;&quot;com.koushikdutta.rommanager&quot;, &quot;com.koushikdutta.rommanager.license&quot;, &quot;com.dimonvideo.luckypatcher&quot;, &quot;com.chelpus.lackypatch&quot;, &quot;com.ramdroid.appquarantine&quot;, &quot;com.ramdroid.appquarantinepro&quot;, &quot;com.android.vending.billing.InAppBillingService.COIN&quot;, &quot;com.android.vending.billing.InAppBillingService.LUCK&quot;, &quot;com.chelpus.luckypatcher&quot;, &quot;com.blackmartalpha&quot;, &quot;org.blackmart.market&quot;, &quot;com.allinone.free&quot;, &quot;com.repodroid.app&quot;, &quot;org.creeplays.hack&quot;, &quot;com.baseappfull.fwd&quot;, &quot;com.zmapp&quot;, &quot;com.dv.marketmod.installer&quot;, &quot;org.mobilism.android&quot;, &quot;com.android.wp.net.log&quot;, &quot;com.android.camera.update&quot;, &quot;cc.madkite.freedom&quot;, &quot;com.solohsu.android.edxp.manager&quot;, &quot;org.meowcat.edxposed.manager&quot;, &quot;com.xmodgame&quot;, &quot;com.cih.game_cih&quot;, &quot;com.charles.lpoqasert&quot;, &quot;catch_.me_.if_.you_.can_&quot;&#125;;</span><br><span class="line">    public static final String[] knownRootCloakingPackages = &#123;&quot;com.devadvance.rootcloak&quot;, &quot;com.devadvance.rootcloakplus&quot;, &quot;de.robv.android.xposed.installer&quot;, &quot;com.saurik.substrate&quot;, &quot;com.zachspong.temprootremovejb&quot;, &quot;com.amphoras.hidemyroot&quot;, &quot;com.amphoras.hidemyrootadfree&quot;, &quot;com.formyhm.hiderootPremium&quot;, &quot;com.formyhm.hideroot&quot;&#125;;</span><br><span class="line">    private static final String[] suPaths = &#123;&quot;/data/local/&quot;, &quot;/data/local/bin/&quot;, &quot;/data/local/xbin/&quot;, &quot;/sbin/&quot;, &quot;/su/bin/&quot;, &quot;/system/bin/&quot;, &quot;/system/bin/.ext/&quot;, &quot;/system/bin/failsafe/&quot;, &quot;/system/sd/xbin/&quot;, &quot;/system/usr/we-need-root/&quot;, &quot;/system/xbin/&quot;, &quot;/cache/&quot;, &quot;/data/&quot;, &quot;/dev/&quot;&#125;;</span><br><span class="line">    static final String[] pathsThatShouldNotBeWritable = &#123;&quot;/system&quot;, &quot;/system/bin&quot;, &quot;/system/sbin&quot;, &quot;/system/xbin&quot;, &quot;/vendor/bin&quot;, &quot;/sbin&quot;, &quot;/etc&quot;&#125;;</span><br><span class="line"></span><br><span class="line">    private Const() throws InstantiationException &#123;</span><br><span class="line">        throw new InstantiationException(&quot;This class is not for instantiation&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /* JADX INFO: Access modifiers changed from: package-private */</span><br><span class="line">    public static String[] getPaths() &#123;</span><br><span class="line">        ArrayList arrayList = new ArrayList(Arrays.asList(suPaths));</span><br><span class="line">        String str = System.getenv(&quot;PATH&quot;);</span><br><span class="line">        if (str != null &amp;&amp; !&quot;&quot;.equals(str)) &#123;</span><br><span class="line">            String[] split = str.split(&quot;:&quot;);</span><br><span class="line">            int length = split.length;</span><br><span class="line">            for (int i2 = 0; i2 &lt; length; i2++) &#123;</span><br><span class="line">                String str2 = split[i2];</span><br><span class="line">                if (!str2.endsWith(FileUriModel.SCHEME)) &#123;</span><br><span class="line">                    str2 = str2 + &#x27;/&#x27;;</span><br><span class="line">                &#125;</span><br><span class="line">                if (!arrayList.contains(str2)) &#123;</span><br><span class="line">                    arrayList.add(str2);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            return (String[]) arrayList.toArray(new String[0]);</span><br><span class="line">        &#125;</span><br><span class="line">        return (String[]) arrayList.toArray(new String[0]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é™„å½•2"><a href="#é™„å½•2" class="headerlink" title="é™„å½•2"></a>é™„å½•2</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public boolean checkForRWPaths() &#123;</span><br><span class="line">    String str;</span><br><span class="line">    String str2;</span><br><span class="line">    String[] strArr;</span><br><span class="line">    String[] mountReader = mountReader();</span><br><span class="line">    if (mountReader == null) &#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">    int i2 = Build.VERSION.SDK_INT;</span><br><span class="line">    int length = mountReader.length;</span><br><span class="line">    int i3 = 0;</span><br><span class="line">    boolean z2 = false;</span><br><span class="line">    while (i3 &lt; length) &#123;</span><br><span class="line">        String str3 = mountReader[i3];</span><br><span class="line">        String[] split = str3.split(&quot; &quot;);</span><br><span class="line">        int i4 = 23;</span><br><span class="line">        if ((i2 &lt;= 23 &amp;&amp; split.length &lt; 4) || (i2 &gt; 23 &amp;&amp; split.length &lt; 6)) &#123;</span><br><span class="line">            QLog.e(&quot;Error formatting mount line: &quot; + str3);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            if (i2 &gt; 23) &#123;</span><br><span class="line">                str = split[2];</span><br><span class="line">                str2 = split[5];</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                str = split[1];</span><br><span class="line">                str2 = split[3];</span><br><span class="line">            &#125;</span><br><span class="line">            String[] strArr2 = Const.pathsThatShouldNotBeWritable;</span><br><span class="line">            int length2 = strArr2.length;</span><br><span class="line">            int i5 = 0;</span><br><span class="line">            while (i5 &lt; length2) &#123;</span><br><span class="line">                String str4 = strArr2[i5];</span><br><span class="line">                if (str.equalsIgnoreCase(str4)) &#123;</span><br><span class="line">                    if (Build.VERSION.SDK_INT &gt; i4) &#123;</span><br><span class="line">                        str2 = str2.replace(&quot;(&quot;, &quot;&quot;).replace(&quot;)&quot;, &quot;&quot;);</span><br><span class="line">                    &#125;</span><br><span class="line">                    String[] split2 = str2.split(&quot;,&quot;);</span><br><span class="line">                    int length3 = split2.length;</span><br><span class="line">                    int i6 = 0;</span><br><span class="line">                    while (i6 &lt; length3) &#123;</span><br><span class="line">                        strArr = mountReader;</span><br><span class="line">                        if (split2[i6].equalsIgnoreCase(&quot;rw&quot;)) &#123;</span><br><span class="line">                            QLog.v(str4 + &quot; path is mounted with rw permissions! &quot; + str3);</span><br><span class="line">                            z2 = true;</span><br><span class="line">                            break;</span><br><span class="line">                        &#125;</span><br><span class="line">                        i6++;</span><br><span class="line">                        mountReader = strArr;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                strArr = mountReader;</span><br><span class="line">                i5++;</span><br><span class="line">                mountReader = strArr;</span><br><span class="line">                i4 = 23;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        i3++;</span><br><span class="line">        mountReader = mountReader;</span><br><span class="line">    &#125;</span><br><span class="line">    return z2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
       <hr><span style="font-style: italic;color: gray;"> è½¬è½½è¯·æ³¨æ˜æ¥æºï¼Œæ¬¢è¿å¯¹æ–‡ç« ä¸­çš„å¼•ç”¨æ¥æºè¿›è¡Œè€ƒè¯ï¼Œäº¤æµè¯·é‚®ä»¶è‡³ 1161629782@qq.com </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">ğŸ’°</a>
</p>






    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    Â©2016-2020 Yelog
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="åˆ‡æ¢å…¨å± å¿«æ·é”® s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">Ã—</a>
    <div class="shang_tit">
        <p>Help us with donation</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="æ‰«ç æ”¯æŒ">
            <img src="/img/weixin.jpg" class="weixin" title="æ‰«ç æ”¯æŒ">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">alipay</label></span><span><label><input type="radio" name="pay" value="weixin">weixin</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*æ¸²æŸ“å¯¹åº”çš„è¡¨æ ¼æ ·å¼*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*æ¸²æŸ“æ‰“èµæ ·å¼*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*é«˜äº®ä»£ç å—è¡Œå·*/
        

        /*è®¿é—®æ•°é‡*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*ä»£ç é«˜äº®ï¼Œè¡Œå·å¯¹é½*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*æ‰“èµé¡µé¢éšè—ä¸å±•ç¤º*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--åŠ å…¥è¡Œå·çš„é«˜äº®ä»£ç å—æ ·å¼-->

<!--è‡ªå®šä¹‰æ ·å¼è®¾ç½®-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*åˆ—è¡¨æ ·å¼*/
    

    /* èƒŒæ™¯å›¾æ ·å¼ */
    
    


    /*å¼•ç”¨å—æ ·å¼*/
    

    /*æ–‡ç« åˆ—è¡¨èƒŒæ™¯å›¾*/
    

    
</style>







</html>
